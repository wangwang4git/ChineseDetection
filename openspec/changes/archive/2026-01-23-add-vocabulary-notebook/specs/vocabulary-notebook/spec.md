# 生字本功能规范

## ADDED Requirements

### Requirement: 生字本页面展示

生字本页面 SHALL 展示用户所有需要学习的汉字，以网格形式呈现。

#### Scenario: 显示生字列表

- **Given**: 用户有 18 个生字在生字本中
- **When**: 用户进入生字本页面
- **Then**: 显示统计卡片，内容为"共 18 个生字需要学习"
- **And**: 以 4 列网格形式展示所有生字卡片
- **And**: 卡片采用循环渐变背景色（粉/蓝/粉紫/黄）

#### Scenario: 生字本为空

- **Given**: 用户生字本中没有任何汉字
- **When**: 用户进入生字本页面
- **Then**: 显示空状态提示"太棒了！没有需要学习的生字"
- **And**: 不显示生字网格

### Requirement: 生字卡片交互

点击生字卡片 SHALL 进入学习模式。

#### Scenario: 点击生字卡片

- **Given**: 用户在生字本页面
- **When**: 用户点击汉字"体"的卡片
- **Then**: 跳转到测试页，传递参数 `mode=vocabulary-learning&char=体`

### Requirement: 返回导航

生字本页面 SHALL 支持返回上一页。

#### Scenario: 点击返回按钮

- **Given**: 用户在生字本页面
- **When**: 用户点击左上角"← 返回"按钮
- **Then**: 返回个人页

### Requirement: 生字学习模式

测试页 SHALL 支持生字学习模式，复用测试页 UI 但行为不同。

#### Scenario: 学习模式 UI

- **Given**: 用户从生字本进入测试页学习模式
- **When**: 页面加载完成
- **Then**: 不显示顶部进度条
- **And**: 不显示鼓励语
- **And**: 显示当前汉字的米字格
- **And**: 显示当前汉字的拼音
- **And**: 显示当前汉字的词组
- **And**: 显示语音播放按钮
- **And**: 显示"我认识"和"不认识"按钮

#### Scenario: 学习模式点击我认识

- **Given**: 用户在学习模式查看汉字"体"
- **When**: 用户点击"我认识"按钮
- **Then**: 汉字"体"从生字本中移除
- **And**: 页面返回生字本
- **And**: 生字本统计数减 1

#### Scenario: 学习模式点击不认识

- **Given**: 用户在学习模式查看汉字"体"
- **When**: 用户点击"不认识"按钮
- **Then**: 汉字"体"保留在生字本中
- **And**: 页面返回生字本
- **And**: 生字本统计数不变

### Requirement: 生字本数据初始化

系统 SHALL 在首次访问时从历史记录初始化生字本。

#### Scenario: 从历史记录初始化

- **Given**: 用户有 3 次历史检测记录
- **And**: 记录 1 的 unknownChars 为 ["体", "连"]
- **And**: 记录 2 的 unknownChars 为 ["连", "众"]
- **And**: 记录 3 的 unknownChars 为 ["少", "体"]
- **When**: 用户首次访问生字本
- **Then**: 生字本初始化为 ["体", "连", "众", "少"]（去重合并）

### Requirement: 生字本自动更新

系统 SHALL 在新测试完成后自动更新生字本。

#### Scenario: 新测试添加生字

- **Given**: 用户生字本当前有 ["体", "连"]
- **When**: 用户完成新测试，unknownChars 为 ["众", "体"]
- **Then**: 生字本更新为 ["体", "连", "众"]（去重合并）
